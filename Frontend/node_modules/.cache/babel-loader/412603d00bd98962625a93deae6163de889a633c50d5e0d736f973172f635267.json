{"ast":null,"code":"\"use strict\";\n\n/**\n * Created by hustcc on 18/5/20.\n * Contract: i@hust.cc\n */\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar SEC_ARRAY = [60, 60, 24, 7, 365 / 7 / 12, 12];\n/**\n * format Date / string / timestamp to Date instance.\n * @param input\n * @returns {*}\n */\nfunction toDate(input) {\n  if (input instanceof Date) return +input;\n  // @ts-ignore\n  if (!isNaN(input) || /^\\d+$/.test(input)) return +new Date(parseInt(input));\n  input = (input || ''\n  // @ts-ignore\n  ).trim().replace(/\\.\\d+/, '') // remove milliseconds\n  .replace(/-/, '/').replace(/-/, '/').replace(/(\\d)T(\\d)/, '$1 $2').replace(/Z/, ' UTC') // 2017-2-5T3:57:52Z -> 2017-2-5 3:57:52UTC\n  .replace(/([+-]\\d\\d):?(\\d\\d)/, ' $1$2'); // -04:00 -> -0400\n  return +new Date(input);\n}\nexports.toDate = toDate;\n/**\n * format the diff second to *** time ago, with setting locale\n * @param diff\n * @param localeFunc\n * @returns\n */\nfunction formatDiff(diff, localeFunc) {\n  // if locale is not exist, use defaultLocale.\n  // if defaultLocale is not exist, use build-in `en`.\n  // be sure of no error when locale is not exist.\n  var agoIn = diff < 0 ? 1 : 0; // time in or time ago\n  diff = Math.abs(diff);\n  var totalSec = diff;\n  var idx = 0;\n  for (; diff >= SEC_ARRAY[idx] && idx < SEC_ARRAY.length; idx++) {\n    diff /= SEC_ARRAY[idx];\n  }\n  diff = ~~diff;\n  idx *= 2;\n  if (diff > (idx === 0 ? 9 : 1)) idx += 1;\n  // @ts-ignore\n  return localeFunc(diff, idx, totalSec)[agoIn].replace('%s', diff);\n}\nexports.formatDiff = formatDiff;\n/**\n * calculate the diff second between date to be formatted an now date.\n * @param date\n * @param relativeDate\n * @returns\n */\nfunction diffSec(date, relativeDate) {\n  relativeDate = relativeDate ? toDate(relativeDate) : +new Date();\n  return (relativeDate - toDate(date)) / 1000;\n}\nexports.diffSec = diffSec;\n/**\n * nextInterval: calculate the next interval time.\n * - diff: the diff sec between now and date to be formatted.\n *\n * What's the meaning?\n * diff = 61 then return 59\n * diff = 3601 (an hour + 1 second), then return 3599\n * make the interval with high performance.\n **/\nfunction nextInterval(diff) {\n  var rst = 1,\n    i = 0,\n    d = Math.abs(diff);\n  for (; diff >= SEC_ARRAY[i] && i < SEC_ARRAY.length; i++) {\n    diff /= SEC_ARRAY[i];\n    rst *= SEC_ARRAY[i];\n  }\n  d = d % rst;\n  d = d ? rst - d : rst;\n  // Math.ceil\n  return ~~d;\n}\nexports.nextInterval = nextInterval;","map":{"version":3,"names":["SEC_ARRAY","toDate","input","Date","isNaN","test","parseInt","trim","replace","exports","formatDiff","diff","localeFunc","agoIn","Math","abs","totalSec","idx","length","diffSec","date","relativeDate","nextInterval","rst","i","d"],"sources":["utils/date.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}